<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href=https://heskeybaozi.github.io/static/favicon.ico>
    <title>工具&组件</title>
    <base target="_blank" />
    <style>
      /* 背景 */
      body {
        margin: 0;
        padding: 0;
      }
      #container {
        position: fixed;
        touch-action: none;
      }

      /* 工具栏 */
      .div_box{
        position: -webkit-sticky;
        position: fixed;
        top: 1%;
        height: 50px; width: 100%;
      }
      .div_box>div{
        position: relative;
        cursor: pointer;
        width: 10%; height: 50px;
        opacity: .3;
        float: left;
        transition:all .7s ease 0s;
      }
      .div_box>div:hover{
        position: relative;
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <div id="container" touch-action="none"></div>
    
    <!-- ------------------ 工具箱 ------------------ -->
      <div class="div_box">
        <!-- 本地文件夹 -->
        <div>
          <a href="E:/" target="_blank"><svg viewBox="0 0 1024 1024" width="50" height="50"><path d="M425.0624 206.464c9.728 0 18.8672 4.4288 24.9088 11.904l2.1248 2.944 45.2864 71.424h242.3552c66.048 0 118.8608 55.5008 121.6512 123.9296l0.128 5.7344v281.6c0 69.12-51.0208 126.464-116.3008 129.536l-5.4784 0.1024H284.2624c-66.048 0-118.8608-55.4752-121.6512-123.904l-0.128-5.7344v-57.9328a32 32 0 0 1 63.8464-3.2512l0.1536 3.2512V704c0 35.3536 24.4224 63.3344 54.0416 65.5104l3.7376 0.128h455.4752c30.0288 0 55.6544-26.5472 57.6512-61.2608l0.128-4.3776v-281.6c0-35.3536-24.4224-63.3344-54.0416-65.5104l-3.7376-0.128H479.8208a32 32 0 0 1-24.9344-11.904l-2.0992-2.9696-45.3376-71.4496-110.5664 0.0256a70.4 70.4 0 0 0-70.272 66.0992l-0.128 4.3008v198.3232a32 32 0 0 1-63.8208 3.2768l-0.1792-3.2768v-198.3232a134.4 134.4 0 0 1 128.8704-134.2976l5.5296-0.1024h128.1792z" fill="#ff0000"></path><path d="M719.36 441.6a32 32 0 0 1 3.2768 63.8464l-3.2768 0.1536H304.64a32 32 0 0 1-3.2768-63.8464l3.2768-0.1536h414.72z" fill="#ff0000"></path></svg></path></svg></a>
        </div>
        <!-- Github -->
        <div>
          <a href="https://github.com/Deil12?tab=repositories" target="_blank"><svg viewBox="0 0 1024 1024" width="50" height="50"><path fill="#fff" d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9 23.5 23.2 38.1 55.4 38.1 91v112.5c0.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"/></svg></a>
        </div>
        <!-- ... -->
        <div>
          <a href="" target="_blank" title="..."><svg viewBox="0 0 1024 1024" width="50" height="50"><path d="M1009.319087 5.274069a31.995081 31.995081 0 0 0-35.194589 0l-959.852422 639.901615a31.995081 31.995081 0 0 0 5.759114 56.311342l250.201532 100.144603 117.741897 206.04832A31.995081 31.995081 0 0 0 416.13029 1023.99744a31.995081 31.995081 0 0 0 27.515769-15.677589l66.549768-110.70298 310.032333 124.140914A31.995081 31.995081 0 0 0 832.06634 1023.99744a31.995081 31.995081 0 0 0 31.99508-26.875867l159.975404-959.852423a31.995081 31.995081 0 0 0-14.717737-31.995081zM100.658794 665.012634L841.984815 170.688637l-539.117111 575.911453a63.990162 63.990162 0 0 0-8.638672-5.119213z m225.565319 105.263816L931.890992 121.096261 416.13029 926.092493z m479.926211 177.252747l-273.237989-109.423176a63.990162 63.990162 0 0 0-19.83695-3.839409L934.450598 182.206866z" fill="#ff0000"></path></svg></a>
        </div>
        <!-- 网易云 -->
        <div style="align-items: center;">
          <a href="https://music.163.com/#/my/m/music/playlist?id=147847032" target="_blank"><svg height="50" width="50" viewBox="0 0 1024 1024"><path fill="#f00" d="M952.17867 503.263237a341.054956 341.054956 0 0 0-56.853199-113.706399 408.604266 408.604266 0 0 0-109.723463-98.352823 304.662484 304.662484 0 0 0-143.257215-42.077792L621.305897 170.238394a40.343287 40.343287 0 0 1 10.792472-36.392472 56.88532 56.88532 0 0 1 36.392472-18.758344 102.785445 102.785445 0 0 1 56.853199 18.758344c6.263488 3.404768 10.792472 9.090088 17.05596 13.073024a57.335006 57.335006 0 0 0 82.999247-70.632873 66.521455 66.521455 0 0 0-22.74128-27.848432 237.691343 237.691343 0 0 0-89.262735-43.202007A170.559598 170.559598 0 0 0 625.288833 6.42409a167.026349 167.026349 0 0 0-60.836135 37.516688 164.328231 164.328231 0 0 0-40.921456 51.713927 156.908407 156.908407 0 0 0-8.54404 113.706399l13.651192 52.870264a284.298118 284.298118 0 0 0-158.064743 109.209535 256.963614 256.963614 0 0 0-43.202007 156.908407 248.419573 248.419573 0 0 0 13.651192 74.487327 205.281807 205.281807 0 0 0 80.718695 104.616312 185.945295 185.945295 0 0 0 136.447679 25.696361 193.879046 193.879046 0 0 0 156.330238-196.705646L708.802008 503.263237c-11.948808-46.060728-24.443664-91.543287-35.814304-137.025847a182.283563 182.283563 0 0 1 47.763112 18.180176 316.611292 316.611292 0 0 1 47.763111 34.690088A239.907654 239.907654 0 0 1 840.752823 529.987453a284.169636 284.169636 0 0 1 0 158.064743 252.241907 252.241907 0 0 1-21.584943 51.167879 308.741782 308.741782 0 0 1-168.279047 144.542033 387.918695 387.918695 0 0 1-130.184191 23.319448 332.607277 332.607277 0 0 1-155.206022-37.516688A367.233124 367.233124 0 0 1 194.87478 672.666499a373.014806 373.014806 0 0 1-20.460727-180.806022A366.173149 366.173149 0 0 1 406.869762 198.536512a57.399247 57.399247 0 0 0 13.073023-100.055207 76.189711 76.189711 0 0 0-63.662735-3.404768A479.815307 479.815307 0 0 0 68.705646 436.163614a488.905395 488.905395 0 0 0 129.027855 450.84266 454.857716 454.857716 0 0 0 248.997741 131.886574 470.885822 470.885822 0 0 0 138.117942 0A454.889837 454.889837 0 0 0 773.042911 952.949561a427.523212 427.523212 0 0 0 170.559598-209.232622 417.276788 417.276788 0 0 0 22.74128-109.209536 378.089837 378.089837 0 0 0-14.165119-131.244166z m-412.747804 118.845671a72.174655 72.174655 0 0 1-56.8532-10.792471 98.352823 98.352823 0 0 1-37.516687-61.382184 170.68808 170.68808 0 0 1 0-65.943287 133.042911 133.042911 0 0 1 33.533751-63.662735 181.35207 181.35207 0 0 1 80.718695-46.606776l39.219072 148.364367a204.189711 204.189711 0 0 1 5.107152 26.146048 79.594479 79.594479 0 0 1-64.208783 73.844918z"></path></svg></a>
        </div>
      </div>

        <!--   播放器  -->
    <!-- require APlayer -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
    <script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
    <!-- require MetingJS -->
    <script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
    <meting-js style="text-align: left; color: red;"
            auto="https://music.163.com/#/playlist?id=974002346"
            fixed="true"
            autoplay="false"
            order="random"
    ></meting-js>
  </body>

  <!-- 背景 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/88/three.min.js"></script>
  <script id="vertexShader" type="x-shader/x-vertex">
    void main() {
        gl_Position = vec4( position, 1.0 );
    }
  </script>
  <script id="fragmentShader" type="x-shader/x-fragment">
    uniform vec2 u_resolution;
    uniform vec2 u_mouse;
    uniform float u_time;
    uniform sampler2D u_noise;

    #define PI 3.141592653589793
    #define TAU 6.

    const float multiplier = 25.5;

    const float zoomSpeed = 10.;
    const int layers = 10;

    const int octaves = 5;

    vec2 hash2(vec2 p)
    {
      vec2 o = texture2D( u_noise, (p+0.5)/256.0, -100.0 ).xy;
      return o;
    }

    mat2 rotate2d(float _angle){
        return mat2(cos(_angle),sin(_angle),
                    -sin(_angle),cos(_angle));
    }

    vec3 hsb2rgb( in vec3 c ){
      vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),
                               6.0)-3.0)-1.0,
                       0.0,
                       1.0 );
      rgb = rgb*rgb*(3.0-2.0*rgb);
      return c.z * mix( vec3(1.0), rgb, c.y);
    }

    float hash(vec2 p)
    {
      float o = texture2D( u_noise, (p+0.5)/256.0, -100.0 ).x;
      return o;
    }
    float noise(vec2 uv) {
      vec2 id = floor(uv);
      vec2 subuv = fract(uv);
      vec2 u = subuv * subuv * (3. - 2. * subuv);
      float a = hash(id);
      float b = hash(id + vec2(1., 0.));
      float c = hash(id + vec2(0., 1.));
      float d = hash(id + vec2(1., 1.));
      return mix(mix(a, b, u.x), mix(c, d, u.x), u.y);
    }
    float fbm(in vec2 uv) {
      float s = .0;
      float m = .0;
      float a = .5;
      for(int i = 0; i < octaves; i++) {
        s += a * noise(uv);
        m += a;
        a *= .5;
        uv *= 2.;
      }
      return s / m;
    }

    vec3 domain(vec2 z){
      return vec3(hsb2rgb(vec3(atan(z.y,z.x)/TAU,1.,1.)));
    }
    vec3 colour(vec2 z) {
        return domain(z);
    }

    // The render function is where we render the pattern to be added to the layer
    vec3 render(vec2 uv, float scale, vec3 colour) {
      vec2 id = floor(uv);
      vec2 subuv = fract(uv);
      vec2 rand = hash2(id);
      float bokeh = abs(scale) * 1.;

      float particle = 0.;

      if(length(rand) > 1.3) {
        vec2 pos = subuv-.5;
        float field = length(pos);
        particle = smoothstep(.3, 0., field);
        particle += smoothstep(.4, 0.34 * bokeh, field);
      }
      return vec3(particle*2.);
    }

    vec3 renderLayer(int layer, int layers, vec2 uv, inout float opacity, vec3 colour, float n) {
      vec2 _uv = uv;
      // Scale
      // Generating a scale value between zero and 1 based on a mod of u_time
      // A frequency of 10 dixided by the layer index (10 / layers * layer)
      float scale = mod((u_time + zoomSpeed / float(layers) * float(layer)) / zoomSpeed, -1.);
      uv *= 20.; // The initial scale. Increasing this makes the cells smaller and the "speed" apepar faster
      uv *= scale*scale; // then modifying the overall scale by the generated amount
      // uv *= 1. + ( ( n*.5 ) * ( length(_uv) ) );
      // uv += .5*float(layer);
      uv = rotate2d(u_time / 10.) * uv; // rotarting
      uv += vec2(25. + sin(u_time*.1)) * float(layer); // ofsetting the UV by an arbitrary amount to make the layer appear different

      // render
      vec3 pass = render(uv * multiplier, scale, colour) * .2; // render the pass

       // this is the opacity of the layer fading in from the "bottom"
      opacity = 1. + scale;
      float _opacity = opacity;

      // pass += n * .5 * mix(vec3(0., .5, 1.5), vec3(1., .5, 0.), opacity);

      // This is the opacity of the layer fading out at the top (we want this minimal, hence the smoothstep)
      float endOpacity = smoothstep(0., 0.4, scale * -1.);
      opacity += endOpacity;

      return pass * _opacity * endOpacity;
    }

    void main() {
        vec2 uv = (gl_FragCoord.xy - 0.5 * u_resolution.xy);

        if(u_resolution.y < u_resolution.x) {
          uv /= u_resolution.y;
        } else {
          uv /= u_resolution.x;
        }

        // uv.y += cos(u_time * .1) * .5;
        // uv.x += sin(u_time * .1) * .5;

        // float n = fbm(uv * 3. - 2.);
        float n = fbm((uv + vec2(sin(u_time*.1), u_time*.1)) * 2. - 2.);

        vec3 colour = vec3(0.);
        // colour = n * mix(vec3(0., .5, 1.5), vec3(1., .5, -.1), n);
        colour = n * mix(vec3(0., .5, 1.5), clamp(vec3(1., .5, .25)*2., 0., 1.), n);
        // colour -= n*n*n*n*.4;
        // colour += smoothstep(.8, 2.5, sin(n*n*n*8.))*.4;

        float opacity = 1.;
        float opacity_sum = 1.;

        for(int i = 1; i <= layers; i++) {
          colour += renderLayer(i, layers, uv, opacity, colour, n);
          opacity_sum += opacity;
        }

        colour /= opacity_sum;

        gl_FragColor = vec4(clamp(colour * 20., 0., 1.),1.0);
    }
  </script>
  <script>
    // 背景
    /*
    Most of the stuff in here is just bootstrapping. Essentially it's just
    setting ThreeJS up so that it renders a flat surface upon which to draw 
    the shader. The only thing to see here really is the uniforms sent to 
    the shader. Apart from that all of the magic happens in the HTML view
    under the fragment shader.
    */
    let container;
    let camera, scene, renderer;
    let uniforms;
    let loader = new THREE.TextureLoader();
    let texture;
    loader.setCrossOrigin("anonymous");
    loader.load(
      "https://s3-us-west-2.amazonaws.com/s.cdpn.io/982762/noise.png",
      function do_something_with_texture(tex) {
        texture = tex;
        texture.wrapS = THREE.RepeatWrapping;
        texture.wrapT = THREE.RepeatWrapping;
        texture.minFilter = THREE.LinearFilter;
        init();
        animate();
      }
    );
    function init() {
      container = document.getElementById("container");
      camera = new THREE.Camera();
      camera.position.z = 1;
      scene = new THREE.Scene();
      var geometry = new THREE.PlaneBufferGeometry(2, 2);
      uniforms = {
        u_time: { type: "f", value: 1.0 },
        u_resolution: { type: "v2", value: new THREE.Vector2() },
        u_noise: { type: "t", value: texture },
        u_mouse: { type: "v2", value: new THREE.Vector2() },
      };
      var material = new THREE.ShaderMaterial({
        uniforms: uniforms,
        vertexShader: document.getElementById("vertexShader").textContent,
        fragmentShader: document.getElementById("fragmentShader").textContent,
      });
      material.extensions.derivatives = true;
      var mesh = new THREE.Mesh(geometry, material);
      scene.add(mesh);
      renderer = new THREE.WebGLRenderer();
      renderer.setPixelRatio(window.devicePixelRatio);
      container.appendChild(renderer.domElement);
      onWindowResize();
      window.addEventListener("resize", onWindowResize, false);
      document.addEventListener("pointermove", (e) => {
        let ratio = window.innerHeight / window.innerWidth;
        uniforms.u_mouse.value.x =
          (e.pageX - window.innerWidth / 2) / window.innerWidth / ratio;
        uniforms.u_mouse.value.y =
          ((e.pageY - window.innerHeight / 2) / window.innerHeight) * -1;
        e.preventDefault();
      });
    }
    function onWindowResize(event) {
      renderer.setSize(window.innerWidth, window.innerHeight);
      uniforms.u_resolution.value.x = renderer.domElement.width;
      uniforms.u_resolution.value.y = renderer.domElement.height;
    }
    function animate(delta) {
      requestAnimationFrame(animate);
      render(delta);
    }
    let capturer = new CCapture({
      verbose: true,
      framerate: 60,
      // motionBlurFrames: 4,
      quality: 90,
      format: "webm",
      workersPath: "js/",
    });
    let capturing = false;
    isCapturing = function (val) {
      if (val === false && window.capturing === true) {
        capturer.stop();
        capturer.save();
      } else if (val === true && window.capturing === false) {
        capturer.start();
      }
      capturing = val;
    };
    toggleCapture = function () {
      isCapturing(!capturing);
    };
    window.addEventListener("keyup", function (e) {
      if (e.keyCode == 68) toggleCapture();
    });
    let then = 0;
    function render(delta) {
      uniforms.u_time.value = -10000 + delta * 0.0005;
      renderer.render(scene, camera);
      if (capturing) {
        capturer.capture(renderer.domElement);
      }
    }
  </script>
</html>
